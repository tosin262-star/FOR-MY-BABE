    <script>
        const canvas = document.getElementById('starCanvas');
        const ctx = canvas.getContext('2d');
        let stars = [];

        function initStars() { 
            canvas.width = window.innerWidth; canvas.height = window.innerHeight; stars = [];
            for(let i=0; i<150; i++) {
                stars.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, size: Math.random()*2.5, blink: Math.random()*0.05, velX: (Math.random()-0.5)*0.2, velY: (Math.random()-0.5)*0.2 });
            }
        }

        function drawStars() {
            ctx.fillStyle = '#000'; ctx.fillRect(0,0,canvas.width, canvas.height);
            stars.forEach(s => { 
                s.x += s.velX; s.y += s.velY;
                if(s.x < 0) s.x = canvas.width; if(s.x > canvas.width) s.x = 0;
                if(s.y < 0) s.y = canvas.height; if(s.y > canvas.height) s.y = 0;
                ctx.fillStyle = `rgba(255,255,255,${Math.abs(Math.sin(Date.now()*s.blink*0.01))})`; 
                ctx.beginPath(); ctx.arc(s.x, s.y, s.size, 0, Math.PI*2); ctx.fill(); 
            });
            requestAnimationFrame(drawStars);
        }

        initStars(); drawStars();
        window.addEventListener('resize', initStars);

        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');

        function startExperience() {
            document.getElementById('song').play();
            transitionSlide();
        }

        function transitionSlide() {
            const oldSlide = slides[currentSlide];
            
            // 1. Prepare the next slide index
            const nextSlideIndex = currentSlide + 1;

            if (nextSlideIndex < slides.length) {
                const nextSlide = slides[nextSlideIndex];

                // 2. Show the next slide IN THE BACKGROUND first
                nextSlide.style.display = 'flex';
                nextSlide.style.opacity = '0';

                // 3. Fade OUT the old slide and Fade IN the new one simultaneously
                setTimeout(() => {
                    oldSlide.style.opacity = '0';
                    nextSlide.style.opacity = '1';
                    
                    // Trigger inner elements (img, p) to fade in
                    const nextElements = nextSlide.querySelectorAll('img, p, h1, button');
                    nextElements.forEach(el => el.style.opacity = '1');
                }, 50);

                // 4. Wait for transition to finish before cleaning up the old slide
                setTimeout(() => {
                    oldSlide.classList.remove('active');
                    oldSlide.style.display = 'none';
                    nextSlide.classList.add('active');
                    currentSlide = nextSlideIndex;

                    // 5. Logic for automatic flow
                    if (currentSlide < slides.length - 2) {
                        setTimeout(transitionSlide, 6000); 
                    }
                }, 1500); // Matches your CSS transition time
            }
        }

        function igniteLove() {
            for (let i = 0; i < 65; i++) {
                setTimeout(() => {
                    const kiss = document.createElement('div'); kiss.className = 'kiss'; kiss.innerHTML = 'ðŸ’‹';
                    kiss.style.left = Math.random()*95+'vw'; kiss.style.bottom='-10vh';
                    document.body.appendChild(kiss); setTimeout(() => kiss.remove(), 3000);
                }, i * 110);
            }
            // Holds on the V-Day message for 6.5s before moving to the Cheers screen
            setTimeout(transitionSlide, 6500);
        }
    </script>
